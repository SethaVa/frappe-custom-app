var q=(n,e,t)=>new Promise((i,s)=>{var o=a=>{try{p(t.next(a))}catch(v){s(v)}},l=a=>{try{p(t.throw(a))}catch(v){s(v)}},p=a=>a.done?i(a.value):Promise.resolve(a.value).then(o,l);p((t=t.apply(n,e)).next())});import{h as d,R as u,j as r,r as z,u as je,b as H,S as ge,L as be,g as Se,c as Ce}from"./index-DIUvhHiv.js";import{B as Ee}from"./Breadcrumb-CB0HX1yW.js";function K(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);e&&(i=i.filter(function(s){return Object.getOwnPropertyDescriptor(n,s).enumerable})),t.push.apply(t,i)}return t}function V(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?K(Object(t),!0).forEach(function(i){Z(n,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):K(Object(t)).forEach(function(i){Object.defineProperty(n,i,Object.getOwnPropertyDescriptor(t,i))})}return n}function B(n){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?B=function(e){return typeof e}:B=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},B(n)}function Z(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function ee(n,e){return Ne(n)||Pe(n,e)||ke(n,e)||we()}function Ne(n){if(Array.isArray(n))return n}function Pe(n,e){var t=n&&(typeof Symbol!="undefined"&&n[Symbol.iterator]||n["@@iterator"]);if(t!=null){var i=[],s=!0,o=!1,l,p;try{for(t=t.call(n);!(s=(l=t.next()).done)&&(i.push(l.value),!(e&&i.length===e));s=!0);}catch(a){o=!0,p=a}finally{try{!s&&t.return!=null&&t.return()}finally{if(o)throw p}}return i}}function ke(n,e){if(n){if(typeof n=="string")return Y(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Y(n,e)}}function Y(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,i=new Array(e);t<e;t++)i[t]=n[t];return i}function we(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var j=function(e,t,i){var s=!!i,o=u.useRef(i);u.useEffect(function(){o.current=i},[i]),u.useEffect(function(){if(!s||!e)return function(){};var l=function(){o.current&&o.current.apply(o,arguments)};return e.on(t,l),function(){e.off(t,l)}},[s,t,e,o])},F=function(e){var t=u.useRef(e);return u.useEffect(function(){t.current=e},[e]),t.current},N=function(e){return e!==null&&B(e)==="object"},Oe=function(e){return N(e)&&typeof e.then=="function"},Ae=function(e){return N(e)&&typeof e.elements=="function"&&typeof e.createToken=="function"&&typeof e.createPaymentMethod=="function"&&typeof e.confirmCardPayment=="function"},G="[object Object]",Re=function n(e,t){if(!N(e)||!N(t))return e===t;var i=Array.isArray(e),s=Array.isArray(t);if(i!==s)return!1;var o=Object.prototype.toString.call(e)===G,l=Object.prototype.toString.call(t)===G;if(o!==l)return!1;if(!o&&!i)return e===t;var p=Object.keys(e),a=Object.keys(t);if(p.length!==a.length)return!1;for(var v={},c=0;c<p.length;c+=1)v[p[c]]=!0;for(var x=0;x<a.length;x+=1)v[a[x]]=!0;var f=Object.keys(v);if(f.length!==p.length)return!1;var g=e,S=t,E=function(O){return n(g[O],S[O])};return f.every(E)},te=function(e,t,i){return N(e)?Object.keys(e).reduce(function(s,o){var l=!N(t)||!Re(e[o],t[o]);return i.includes(o)?(l&&console.warn("Unsupported prop change: options.".concat(o," is not a mutable property.")),s):l?V(V({},s||{}),{},Z({},o,e[o])):s},null):null},re="Invalid prop `stripe` supplied to `Elements`. We recommend using the `loadStripe` utility from `@stripe/stripe-js`. See https://stripe.com/docs/stripe-js/react#elements-props-stripe for details.",J=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:re;if(e===null||Ae(e))return e;throw new Error(t)},_e=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:re;if(Oe(e))return{tag:"async",stripePromise:Promise.resolve(e).then(function(s){return J(s,t)})};var i=J(e,t);return i===null?{tag:"empty"}:{tag:"sync",stripe:i}},Le=function(e){!e||!e._registerWrapper||!e.registerAppInfo||(e._registerWrapper({name:"react-stripe-js",version:"3.1.0"}),e.registerAppInfo({name:"react-stripe-js",version:"3.1.0",url:"https://stripe.com/docs/stripe-js/react"}))},U=u.createContext(null);U.displayName="ElementsContext";var ne=function(e,t){if(!e)throw new Error("Could not find Elements context; You need to wrap the part of your app that ".concat(t," in an <Elements> provider."));return e},ie=function(e){var t=e.stripe,i=e.options,s=e.children,o=u.useMemo(function(){return _e(t)},[t]),l=u.useState(function(){return{stripe:o.tag==="sync"?o.stripe:null,elements:o.tag==="sync"?o.stripe.elements(i):null}}),p=ee(l,2),a=p[0],v=p[1];u.useEffect(function(){var f=!0,g=function(E){v(function(P){return P.stripe?P:{stripe:E,elements:E.elements(i)}})};return o.tag==="async"&&!a.stripe?o.stripePromise.then(function(S){S&&f&&g(S)}):o.tag==="sync"&&!a.stripe&&g(o.stripe),function(){f=!1}},[o,a,i]);var c=F(t);u.useEffect(function(){c!==null&&c!==t&&console.warn("Unsupported prop change on Elements: You cannot change the `stripe` prop after setting it.")},[c,t]);var x=F(i);return u.useEffect(function(){if(a.elements){var f=te(i,x,["clientSecret","fonts"]);f&&a.elements.update(f)}},[i,x,a.elements]),u.useEffect(function(){Le(a.stripe)},[a.stripe]),u.createElement(U.Provider,{value:a},s)};ie.propTypes={stripe:d.any,options:d.object};var Te=function(e){var t=u.useContext(U);return ne(t,e)},Be=function(){var e=Te("calls useElements()"),t=e.elements;return t};d.func.isRequired;var se=u.createContext(null);se.displayName="CheckoutSdkContext";var Ue=function(e,t){if(!e)throw new Error("Could not find CheckoutProvider context; You need to wrap the part of your app that ".concat(t," in an <CheckoutProvider> provider."));return e},Me=u.createContext(null);Me.displayName="CheckoutContext";d.any,d.shape({clientSecret:d.string.isRequired,elementsOptions:d.object}).isRequired;var D=function(e){var t=u.useContext(se),i=u.useContext(U);if(t&&i)throw new Error("You cannot wrap the part of your app that ".concat(e," in both <CheckoutProvider> and <Elements> providers."));return t?Ue(t,e):ne(i,e)},We=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},m=function(e,t){var i="".concat(We(e),"Element"),s=function(a){var v=a.id,c=a.className,x=a.options,f=x===void 0?{}:x,g=a.onBlur,S=a.onFocus,E=a.onReady,P=a.onChange,O=a.onEscape,le=a.onClick,ue=a.onLoadError,de=a.onLoaderStart,pe=a.onNetworksChange,fe=a.onConfirm,me=a.onCancel,he=a.onShippingAddressChange,ve=a.onShippingRateChange,A=D("mounts <".concat(i,">")),R="elements"in A?A.elements:null,_="checkoutSdk"in A?A.checkoutSdk:null,ye=u.useState(null),I=ee(ye,2),y=I[0],xe=I[1],C=u.useRef(null),M=u.useRef(null);j(y,"blur",g),j(y,"focus",S),j(y,"escape",O),j(y,"click",le),j(y,"loaderror",ue),j(y,"loaderstart",de),j(y,"networkschange",pe),j(y,"confirm",fe),j(y,"cancel",me),j(y,"shippingaddresschange",he),j(y,"shippingratechange",ve),j(y,"change",P);var W;E&&(e==="expressCheckout"?W=E:W=function(){E(y)}),j(y,"ready",W),u.useLayoutEffect(function(){if(C.current===null&&M.current!==null&&(R||_)){var b=null;_?b=_.createElement(e,f):R&&(b=R.create(e,f)),C.current=b,xe(b),b&&b.mount(M.current)}},[R,_,f]);var $=F(f);return u.useEffect(function(){if(C.current){var b=te(f,$,["paymentRequest"]);b&&"update"in C.current&&C.current.update(b)}},[f,$]),u.useLayoutEffect(function(){return function(){if(C.current&&typeof C.current.destroy=="function")try{C.current.destroy(),C.current=null}catch(b){}}},[]),u.createElement("div",{id:v,className:c,ref:M})},o=function(a){D("mounts <".concat(i,">"));var v=a.id,c=a.className;return u.createElement("div",{id:v,className:c})},l=t?o:s;return l.propTypes={id:d.string,className:d.string,onChange:d.func,onBlur:d.func,onFocus:d.func,onReady:d.func,onEscape:d.func,onClick:d.func,onLoadError:d.func,onLoaderStart:d.func,onNetworksChange:d.func,onConfirm:d.func,onCancel:d.func,onShippingAddressChange:d.func,onShippingRateChange:d.func,options:d.object},l.displayName=i,l.__elementType=e,l},h=typeof window=="undefined",qe=u.createContext(null);qe.displayName="EmbeddedCheckoutProviderContext";var Fe=function(){var e=D("calls useStripe()"),t=e.stripe;return t};m("auBankAccount",h);var Q=m("card",h);m("cardNumber",h);m("cardExpiry",h);m("cardCvc",h);m("fpxBank",h);m("iban",h);m("idealBank",h);m("p24Bank",h);m("epsBank",h);m("payment",h);m("expressCheckout",h);m("currencySelector",h);m("paymentRequestButton",h);m("linkAuthentication",h);m("address",h);m("shippingAddress",h);m("paymentMethodMessaging",h);m("affirmMessage",h);m("afterpayClearpayMessage",h);var ae="https://js.stripe.com/v3",De=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/;var Ie=function(){for(var e=document.querySelectorAll('script[src^="'.concat(ae,'"]')),t=0;t<e.length;t++){var i=e[t];if(De.test(i.src))return i}return null},X=function(e){var t="",i=document.createElement("script");i.src="".concat(ae).concat(t);var s=document.head||document.body;if(!s)throw new Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return s.appendChild(i),i},$e=function(e,t){!e||!e._registerWrapper||e._registerWrapper({name:"stripe-js",version:"5.5.0",startTime:t})},k=null,L=null,T=null,ze=function(e){return function(){e(new Error("Failed to load Stripe.js"))}},He=function(e,t){return function(){window.Stripe?e(window.Stripe):t(new Error("Stripe.js not available"))}},Ke=function(e){return k!==null?k:(k=new Promise(function(t,i){if(typeof window=="undefined"||typeof document=="undefined"){t(null);return}if(window.Stripe){t(window.Stripe);return}try{var s=Ie();if(!(s&&e)){if(!s)s=X(e);else if(s&&T!==null&&L!==null){var o;s.removeEventListener("load",T),s.removeEventListener("error",L),(o=s.parentNode)===null||o===void 0||o.removeChild(s),s=X(e)}}T=He(t,i),L=ze(i),s.addEventListener("load",T),s.addEventListener("error",L)}catch(l){i(l);return}}),k.catch(function(t){return k=null,Promise.reject(t)}))},Ve=function(e,t,i){if(e===null)return null;var s=e.apply(void 0,t);return $e(s,i),s},w,oe=!1,ce=function(){return w||(w=Ke(null).catch(function(e){return w=null,Promise.reject(e)}),w)};Promise.resolve().then(function(){return ce()}).catch(function(n){oe||console.warn(n)});var Ye=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];oe=!0;var s=Date.now();return ce().then(function(o){return Ve(o,t,s)})};const Ge=Ye("pk_test_51OI9m0Hsp0B3Hu8HL7mzACeBe7g9w3GSe6Tj7uNAziMNyptoQz1OnK1n7xwLttBQvk5g921UNMUHei5RhlmSLLpP00si3VuQMe"),Je="/evcar",tt=()=>r.jsx(ie,{stripe:Ge,children:r.jsx(Qe,{})}),Qe=()=>{const n=Fe(),e=Be(),[t,i]=z.useState("");console.log();let s=0,{pathname:o}=je();const l=H(c=>c.currency),{cartItems:p}=H(c=>c.cart),a=()=>q(void 0,null,function*(){v()}),v=()=>q(void 0,null,function*(){try{const c=yield fetch("/api/method/evcar.api.payment.checkout_with_stripe",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({cart_items:p,customer:"Test User",payment_method:"stripe",delivery_date:"2025/12/12",billing_address:{address_line1:"123 Main St",city:"Phnom Penh",country:"Cambodia"},shipping_address:{address_line1:"456 Elm St",city:"Phnom Penh",country:"Cambodia"}})});if(!c.ok)throw new Error("Network response was not ok");const x=yield c.json();i(x.message.payment_intent_client_secret);const{error:f,paymentIntent:g}=yield n.confirmCardPayment(t,{payment_method:{card:e.getElement(Q)}});f?console.error(f.message):console.log("Payment successful:",g)}catch(c){console.error("Error fetching data:",c.message)}});return r.jsxs(z.Fragment,{children:[r.jsx(ge,{titleTemplate:"Checkout",description:"Checkout page of flone react minimalist eCommerce template."}),r.jsxs(be,{headerTop:"visible",children:[r.jsx(Ee,{pages:[{label:"Home",path:"/"},{label:"Checkout",path:o}]}),r.jsx("div",{className:"checkout-area pt-95 pb-100",children:r.jsx("div",{className:"container",children:p&&p.length>=1?r.jsxs("div",{className:"row",children:[r.jsx("div",{className:"col-lg-7",children:r.jsxs("div",{className:"billing-info-wrap",children:[r.jsx("h3",{children:"Billing Details"}),r.jsxs("div",{className:"row",children:[r.jsx("div",{className:"col-lg-12",children:r.jsxs("div",{className:"billing-info mb-20",children:[r.jsx("label",{children:"Credit Card"}),r.jsx("div",{style:{fontSize:"14px",color:"#333",border:"1px solid #e6e6e6",background:"transparent none repeat scroll 0 0",padding:"16px"},children:r.jsx(Q,{})})]})}),r.jsx("div",{className:"col-lg-6 col-md-6",children:r.jsxs("div",{className:"billing-info mb-20",children:[r.jsx("label",{children:"First Name"}),r.jsx("input",{type:"text"})]})}),r.jsx("div",{className:"col-lg-6 col-md-6",children:r.jsxs("div",{className:"billing-info mb-20",children:[r.jsx("label",{children:"Last Name"}),r.jsx("input",{type:"text"})]})}),r.jsx("div",{className:"col-lg-12",children:r.jsxs("div",{className:"billing-info mb-20",children:[r.jsx("label",{children:"Company Name"}),r.jsx("input",{type:"text"})]})}),r.jsx("div",{className:"col-lg-12",children:r.jsxs("div",{className:"billing-select mb-20",children:[r.jsx("label",{children:"Country"}),r.jsxs("select",{children:[r.jsx("option",{children:"Select a country"}),r.jsx("option",{children:"Azerbaijan"}),r.jsx("option",{children:"Bahamas"}),r.jsx("option",{children:"Bahrain"}),r.jsx("option",{children:"Bangladesh"}),r.jsx("option",{children:"Barbados"})]})]})}),r.jsx("div",{className:"col-lg-12",children:r.jsxs("div",{className:"billing-info mb-20",children:[r.jsx("label",{children:"Street Address"}),r.jsx("input",{className:"billing-address",placeholder:"House number and street name",type:"text"}),r.jsx("input",{placeholder:"Apartment, suite, unit etc.",type:"text"})]})}),r.jsx("div",{className:"col-lg-12",children:r.jsxs("div",{className:"billing-info mb-20",children:[r.jsx("label",{children:"Town / City"}),r.jsx("input",{type:"text"})]})}),r.jsx("div",{className:"col-lg-6 col-md-6",children:r.jsxs("div",{className:"billing-info mb-20",children:[r.jsx("label",{children:"State / County"}),r.jsx("input",{type:"text"})]})}),r.jsx("div",{className:"col-lg-6 col-md-6",children:r.jsxs("div",{className:"billing-info mb-20",children:[r.jsx("label",{children:"Postcode / ZIP"}),r.jsx("input",{type:"text"})]})}),r.jsx("div",{className:"col-lg-6 col-md-6",children:r.jsxs("div",{className:"billing-info mb-20",children:[r.jsx("label",{children:"Phone"}),r.jsx("input",{type:"text"})]})}),r.jsx("div",{className:"col-lg-6 col-md-6",children:r.jsxs("div",{className:"billing-info mb-20",children:[r.jsx("label",{children:"Email Address"}),r.jsx("input",{type:"text"})]})})]}),r.jsxs("div",{className:"additional-info-wrap",children:[r.jsx("h4",{children:"Additional information"}),r.jsxs("div",{className:"additional-info",children:[r.jsx("label",{children:"Order notes"}),r.jsx("textarea",{placeholder:"Notes about your order, e.g. special notes for delivery. ",name:"message",defaultValue:""})]})]})]})}),r.jsx("div",{className:"col-lg-5",children:r.jsxs("div",{className:"your-order-area",children:[r.jsx("h3",{children:"Your order"}),r.jsxs("div",{className:"your-order-wrap gray-bg-4",children:[r.jsxs("div",{className:"your-order-product-info",children:[r.jsx("div",{className:"your-order-top",children:r.jsxs("ul",{children:[r.jsx("li",{children:"Product"}),r.jsx("li",{children:"Total"})]})}),r.jsx("div",{className:"your-order-middle",children:r.jsx("ul",{children:p.map((c,x)=>{const f=Se(c.valuation_rate,c.discount),g=(c.valuation_rate*l.currencyRate).toFixed(2),S=(f*l.currencyRate).toFixed(2);return f!=null?s+=S*c.quantity:s+=g*c.quantity,r.jsxs("li",{children:[r.jsxs("span",{className:"order-middle-left",children:[c.item_name," X ",c.quantity]})," ",r.jsx("span",{className:"order-price",children:f!==null?l.currencySymbol+(S*c.quantity).toFixed(2):l.currencySymbol+(g*c.quantity).toFixed(2)})]},x)})})}),r.jsx("div",{className:"your-order-bottom",children:r.jsxs("ul",{children:[r.jsx("li",{className:"your-order-shipping",children:"Shipping"}),r.jsx("li",{children:"Free shipping"})]})}),r.jsx("div",{className:"your-order-total",children:r.jsxs("ul",{children:[r.jsx("li",{className:"order-total",children:"Total"}),r.jsx("li",{children:l.currencySymbol+s.toFixed(2)})]})})]}),r.jsx("div",{className:"payment-method"})]}),r.jsx("div",{className:"place-order mt-25",children:r.jsx("button",{className:"btn-hover",onClick:a,children:"Place Order"})})]})})]}):r.jsx("div",{className:"row",children:r.jsx("div",{className:"col-lg-12",children:r.jsxs("div",{className:"item-empty-area text-center",children:[r.jsx("div",{className:"item-empty-area__icon mb-30",children:r.jsx("i",{className:"pe-7s-cash"})}),r.jsxs("div",{className:"item-empty-area__text",children:["No items found in cart to checkout ",r.jsx("br",{})," ",r.jsx(Ce,{to:Je+"/collection",children:"Shop Now"})]})]})})})})})]})]})};export{tt as default};
